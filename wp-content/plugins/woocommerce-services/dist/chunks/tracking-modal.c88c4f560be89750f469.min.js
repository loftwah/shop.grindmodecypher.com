(window.webpackJsonp=window.webpackJsonp||[]).push([[146],{632:function(e,t,n){"use strict";var i=n(107),o=n.n(i),a=n(108),r=n.n(a),s=n(528),l=n.n(s),c=n(527),u=n.n(c),d=n(531),p=n.n(d),m=n(529),h=n.n(m),f=n(34),b=n.n(f),g=n(12),v=n.n(g),y=n(10),E=n.n(y),k=n(76),w=n.n(k),C=n(109),R=n(47),_=n.n(R),D=n(526),N=n.n(D),I=n(660),O=n.n(I),P=n(1),j=n(599),x=n(78),T=n.n(x),q=n(670),L=n.n(q),M=_()("calypso:popover:util");function S(){var e={};return e.top=window.scrollY,e.left=window.scrollX,e.width=window.innerWidth,e.height=window.innerHeight,e.right=e.left+e.width,e.bottom=e.top+e.height,M("viewport: %o",e),e}var z={top:"bottom",bottom:"top",left:"right",right:"left"},A={top:"right",left:"top",bottom:"left",right:"bottom"},V=S();function B(){V=S()}var H=!1,U=function(){if(H)return M("window events already bound");H=!0,M("bind handlers to `resize` and `scroll` events"),window.addEventListener("resize",B,!0),window.addEventListener("scroll",B,!0)},F=function(){if(!H)return M("window events are not bound");H=!1,M("unbind handlers to `resize` and `scroll` events"),window.removeEventListener("resize",B,!0),window.removeEventListener("scroll",B,!0)},K=function(e,t,n){var i=L()(n),o=t.clientHeight,a=t.clientWidth,r={top:i.top-o,bottom:V.height-i.bottom-o,left:i.left-a,right:V.width-i.right-a},s=e.split(/\s+/),l=T()(s,1)[0],c=T()(s,2)[1],u=function(e,t){for(var n,i=[e,z[e],A[e],z[A[e]]],o=-1/0,a=0,r=i.length;a<r;a++){var s=i[a],l=t[s];if(l>0)return s;l>o&&(o=l,n=e)}return n}(l,r);return c!==u&&c!==z[u]||(c=null),function(e,t,n,i,o,a){for(var r,s="top"===e||"bottom"===e,l=t?[s?"".concat(e," ").concat(t):"".concat(t," ").concat(e),e,s?"".concat(e," ").concat(z[t]):"".concat(z[t]," ").concat(e)]:[e,s?"".concat(e," ").concat(A[e]):"".concat(A[e]," ").concat(e),s?"".concat(e," ").concat(z[A[e]]):"".concat(z[A[e]]," ").concat(e)],c=0,u=o*a,d=0,p=l.length;d<p;d++){var m=l[d],h=W(m,n,i),f=h.left+o,b=h.top+a,g=Math.min(h.top<V.top?b-V.top:V.bottom-h.top,a),v=Math.min(h.left<V.left?f-V.left:V.right-h.left,o),y=v*g;if(y===u)return m;y>c&&(c=y,r=m)}return r}(u,c,t,n,a,o)||e};function W(e,t,n,i){var o=L()(t);if(!o)throw new Error("could not get bounding client rect of Tip element");var a=o.width,r=o.height,s=L()(n);if(!s)throw new Error("could not get bounding client rect of `target`");var l=s.width,c=s.height,u=function(e,t){var n=t.body||t.getElementsByTagName("body")[0],i=t.documentElement||n.parentNode,o=i.clientTop||n.clientTop||0,a=i.clientLeft||n.clientLeft||0,r=window.pageYOffset||i.scrollTop,s=window.pageXOffset||i.scrollLeft;return{top:e.top+r-o,left:e.left+s-a}}(s,document);if(!u)throw new Error("could not determine page offset of `target`");var d={};switch(e){case"top":d={top:u.top-r,left:i&&i.left?u.left+i.left:u.left+l/2-a/2};break;case"bottom":d={top:u.top+c,left:i&&i.left?u.left+i.left:u.left+l/2-a/2};break;case"right":d={top:u.top+c/2-r/2,left:u.left+l};break;case"left":d={top:u.top+c/2-r/2,left:u.left-a};break;case"top left":d={top:u.top-r,left:u.left+l/2-a+15};break;case"top right":d={top:u.top-r,left:u.left+l/2-15};break;case"bottom left":d={top:u.top+c,left:u.left+l/2-a+15};break;case"bottom right":d={top:u.top+c,left:u.left+l/2-15};break;case"left top":d={top:u.top+c/2-r,left:u.left-a};break;case"left bottom":d={top:u.top+c/2,left:u.left-a};break;case"right top":d={top:u.top+c/2-r,left:u.left+l};break;case"right bottom":d={top:u.top+c/2,left:u.left+l};break;default:throw new Error('invalid position "'.concat(e,'"'))}return d}var Y=function(){},J=_()("calypso:popover"),X=new Set,G=function(e){function t(e){var n;return o()(this,t),n=l()(this,u()(t).call(this,e)),b()(p()(n),"isUpdatingPosition",!1),n.setPopoverId(e.id),n.setDOMBehavior=n.setDOMBehavior.bind(p()(n)),n.setPosition=n.setPosition.bind(p()(n)),n.onClickout=n.onClickout.bind(p()(n)),n.onKeydown=n.onKeydown.bind(p()(n)),n.onWindowChange=n.onWindowChange.bind(p()(n)),n.state={show:e.isVisible,left:-99999,top:-99999,positionClass:n.getPositionClass(e.position)},n}return h()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.state.show&&(this.bindEscKeyListener(),this.bindDebouncedReposition(),U())}},{key:"componentWillReceiveProps",value:function(e){if(this.domContext=w.a.findDOMNode(e.context),!e.isVisible)return null;this.setPosition()}},{key:"componentDidUpdate",value:function(e,t){var n=this,i=this.props.isVisible;return!t.show&&this.state.show&&(this.bindEscKeyListener(),this.bindDebouncedReposition(),U()),i!==e.isVisible&&(i?this.show():this.hide()),this.domContainer&&this.domContext&&i?void(this.isUpdatingPosition||(this.debug("requesting to update position after render completes"),requestAnimationFrame(function(){X.has(n.id)&&n.domContainer&&n.domContext&&i?(n.setPosition(),n.isUpdatingPosition=!1):n.isUpdatingPosition=!1}),this.isUpdatingPosition=!0)):null}},{key:"componentWillUnmount",value:function(){this.debug("unmounting .... "),this.unbindClickoutHandler(),this.unbindDebouncedReposition(),this.unbindEscKeyListener(),F(),X.delete(this.id),J("current popover instances: ",X.size)}},{key:"bindEscKeyListener",value:function(){if(!this.props.closeOnEsc)return null;this.debug("adding escKey listener ..."),document.addEventListener("keydown",this.onKeydown,!0)}},{key:"unbindEscKeyListener",value:function(){if(!this.props.closeOnEsc)return null;this.debug("unbinding `escKey` listener ..."),document.removeEventListener("keydown",this.onKeydown,!0)}},{key:"onKeydown",value:function(e){if(27!==e.keyCode)return null;this.close(!0)}},{key:"bindClickoutHandler",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.domContainer;return e?this._clickoutHandlerReference?(this.debug("clickout event already bound"),null):(this.debug("binding `clickout` event"),void(this._clickoutHandlerReference=O()(e,this.onClickout))):(this.debug("no element to bind clickout "),null)}},{key:"unbindClickoutHandler",value:function(){this._clickoutHandlerReference&&(this.debug("unbinding `clickout` listener ..."),this._clickoutHandlerReference(),this._clickoutHandlerReference=null)}},{key:"onClickout",value:function(e){var t=this.domContext&&this.domContext.contains&&!this.domContext.contains(e.target);if(this.props.ignoreContext&&t){var n=w.a.findDOMNode(this.props.ignoreContext);t=t&&n&&n.contains&&!n.contains(e.target)}t&&this.close()}},{key:"bindDebouncedReposition",value:function(){window.addEventListener("scroll",this.onWindowChange,!0),window.addEventListener("resize",this.onWindowChange,!0)}},{key:"unbindDebouncedReposition",value:function(){this.willReposition&&(window.cancelAnimationFrame(this.willReposition),this.willReposition=null),window.removeEventListener("scroll",this.onWindowChange,!0),window.removeEventListener("resize",this.onWindowChange,!0),this.debug("unbinding `debounce reposition` ...")}},{key:"onWindowChange",value:function(){this.willReposition=window.requestAnimationFrame(this.setPosition)}},{key:"setDOMBehavior",value:function(e){if(!e)return this.unbindClickoutHandler(),null;this.debug("setting DOM behavior"),this.bindClickoutHandler(e),this.domContainer=e,this.domContext=w.a.findDOMNode(this.props.context),this.setPosition()}},{key:"getPositionClass",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.position;return"is-".concat(e.replace(/\s+/g,"-"))}},{key:"adjustRtlPosition",value:function(e){if(this.props.isRtl)switch(e){case"top right":case"right top":return"top left";case"right":return"left";case"bottom right":case"right bottom":return"bottom left";case"bottom left":case"left bottom":return"bottom right";case"left":return"right";case"top left":case"left top":return"top right"}return e}},{key:"computePosition",value:function(){if(!this.props.isVisible)return null;var e=this.domContainer,t=this.domContext,n=this.props,i=n.position,o=n.relativePosition;if(!e||!t)return this.debug("[WARN] no DOM elements to work"),null;var a=i;this.debug("position: %o",a),this.props.autoRtl&&(a=this.adjustRtlPosition(a),this.debug("RTL adjusted position: %o",a)),this.props.autoPosition&&(a=K(a,e,t),this.debug("suggested position: %o",a));var r=Object.assign({},function(e,t){var n=L()(t).width;return e.left=Math.max(0,Math.min(e.left,V.width-n)),e}(W(a,e,t,o),e),{positionClass:this.getPositionClass(a)});return this.debug("updating reposition: ",r),r}},{key:"debug",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];J.apply(void 0,["[%s] ".concat(e),this.id].concat(n))}},{key:"setPopoverId",value:function(e){this.id=e||"pop__".concat(Object(P.uniqueId)()),X.add(this.id),this.debug("creating ..."),J("current popover instances: ",X.size)}},{key:"setPosition",value:function(){var e;if(this.debug("updating position"),!(e=this.props.customPosition?Object.assign({positionClass:this.getPositionClass(this.constructor.defaultProps.position)},this.props.customPosition):this.computePosition()))return null;this.willReposition=null,this.setState(e)}},{key:"getStylePosition",value:function(){var e=this.state;return{left:e.left,top:e.top}}},{key:"show",value:function(){var e=this;if(!this.props.showDelay)return this.setState({show:!0}),null;this.debug("showing in %o","".concat(this.props.showDelay,"ms")),this.clearShowTimer(),this._openDelayTimer=setTimeout(function(){e.setState({show:!0})},this.props.showDelay)}},{key:"hide",value:function(){this.unbindClickoutHandler(),this.unbindDebouncedReposition(),this.unbindEscKeyListener(),F(),this.setState({show:!1}),this.clearShowTimer()}},{key:"clearShowTimer",value:function(){if(!this._openDelayTimer)return null;clearTimeout(this._openDelayTimer),this._openDelayTimer=null}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.props.isVisible)return this.debug("popover should be already closed"),null;this.props.onClose(e)}},{key:"render",value:function(){if(!this.state.show)return this.debug("is hidden. return no render"),null;if(!this.props.context)return this.debug("No `context` to tie. return no render"),null;var e=N()("popover",this.props.className,this.state.positionClass);return this.debug("rendering ..."),E.a.createElement(j.a,{className:this.props.rootClassName},E.a.createElement("div",{style:this.getStylePosition(),className:e},E.a.createElement("div",{className:"popover__arrow"}),E.a.createElement("div",{ref:this.setDOMBehavior,className:"popover__inner"},this.props.children)))}}]),t}(y.Component);b()(G,"propTypes",{autoPosition:v.a.bool,autoRtl:v.a.bool,className:v.a.string,closeOnEsc:v.a.bool,id:v.a.string,ignoreContext:v.a.shape({getDOMNode:v.a.function}),isRtl:v.a.bool,isVisible:v.a.bool,position:v.a.oneOf(["top","top right","right","bottom right","bottom","bottom left","left","top left"]),rootClassName:v.a.string,showDelay:v.a.number,onClose:v.a.func,onShow:v.a.func,relativePosition:v.a.shape({left:v.a.number}),customPosition:v.a.shape({top:v.a.number,left:v.a.number,positionClass:v.a.oneOf(["top","right","bottom","left"])})}),b()(G,"defaultProps",{autoPosition:!0,autoRtl:!0,className:"",closeOnEsc:!0,isRtl:!1,isVisible:!1,position:"top",showDelay:0,onClose:Y,onShow:Y});t.a=Object(C.b)(function(e){return{isRtl:document.body.classList.contains("rtl")}})(G)},679:function(e,t,n){},680:function(e,t,n){},682:function(e,t,n){"use strict";var i=n(107),o=n.n(i),a=n(108),r=n.n(a),s=n(528),l=n.n(s),c=n(527),u=n.n(c),d=n(531),p=n.n(d),m=n(529),h=n.n(m),f=n(34),b=n.n(f),g=n(109),v=n(35),y=n(12),E=n.n(y),k=n(10),w=n.n(k),C=n(1),R=(n(679),n(613)),_=n(534),D=n.n(_),N=n(581),I=n.n(N),O=n(30),P=n(789),j=n(526),x=n.n(j),T=n(544),q=n(632),L=function(e){return"HR"===e.tagName},M=function(e){function t(){var e,n;o()(this,t);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return n=l()(this,(e=u()(t)).call.apply(e,[this].concat(a))),b()(p()(n),"menu",w.a.createRef()),b()(p()(n),"_setPropsOnChild",function(e){if(null==e)return e;var t=n._onClose.bind(p()(n),e.props.action),i=t;return e.props.onClick&&(i=Object(C.over)([e.props.onClick,t])),w.a.cloneElement(e,{onClick:i})}),b()(p()(n),"_onShow",function(){var e=n.menu.current;n._previouslyFocusedElement=document.activeElement,e&&e.focus()}),b()(p()(n),"_getClosestSibling",function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=n.menu.current,o=i.firstChild,a=i.lastChild;if(t||(o=i.lastChild,a=i.firstChild),e===i)return o;var r=e[t?"nextSibling":"previousSibling"]||a;return L(r)?n._getClosestSibling(r,t):r}),b()(p()(n),"_onKeyDown",function(e){var t,i=e.target,o=!1;switch(e.keyCode){case 9:n.props.onClose(),o=!0;break;case 38:t=n._getClosestSibling(i,!1),o=!0;break;case 40:t=n._getClosestSibling(i,!0),o=!0}t&&t.focus(),o&&e.preventDefault()}),b()(p()(n),"_onClose",function(e){n._previouslyFocusedElement&&(n._previouslyFocusedElement.focus(),n._previouslyFocusedElement=null),n.props.onClose&&n.props.onClose(e)}),n}return h()(t,e),r()(t,[{key:"componentWillUnmount",value:function(){this._previouslyFocusedElement=null}},{key:"render",value:function(){var e=this.props,t=e.popoverComponent,n=e.autoPosition,i=e.className,o=e.context,a=e.customPosition,r=e.isVisible,s=e.popoverTitle,l=e.position,c=e.rootClassName;return w.a.createElement(t,{onClose:this._onClose,onShow:this._onShow,autoPosition:n,className:i,context:o,customPosition:a,isVisible:r,popoverTitle:s,position:l,rootClassName:c},w.a.createElement("div",{ref:this.menu,role:"menu",className:"popover__menu",onKeyDown:this._onKeyDown,tabIndex:"-1"},w.a.Children.map(this.props.children,this._setPropsOnChild,this)))}}]),t}(k.Component);b()(M,"propTypes",{autoPosition:E.a.bool,isVisible:E.a.bool.isRequired,onClose:E.a.func.isRequired,position:E.a.string,className:E.a.string,rootClassName:E.a.string,popoverComponent:E.a.func,popoverTitle:E.a.string,customPosition:E.a.object}),b()(M,"defaultProps",{autoPosition:!0,position:"top",popoverComponent:q.a});var S=M,z=(n(680),function(e){function t(){var e,n;o()(this,t);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return n=l()(this,(e=u()(t)).call.apply(e,[this].concat(a))),b()(p()(n),"state",{isMenuVisible:!1}),b()(p()(n),"popoverContext",w.a.createRef()),b()(p()(n),"handleClick",function(e){var t=n.props.onClick,i=n.state.isMenuVisible;t(e),i?n.hideMenu():n.showMenu()}),b()(p()(n),"hideMenu",function(){return n.toggleMenu(!1)}),b()(p()(n),"showMenu",function(){return n.toggleMenu(!0)}),n}return h()(t,e),r()(t,[{key:"toggleMenu",value:function(e){this.props.disabled||(this.setState({isMenuVisible:e}),this.props.onToggle(e))}},{key:"render",value:function(){var e=this.props,t=e.toggleTitle,n=e.translate,i=e.position,o=e.children,a=e.disabled,r=e.className,s=e.popoverClassName,l=this.state.isMenuVisible,c=x()("ellipsis-menu",r,{"is-menu-visible":l,"is-disabled":a}),u=x()("ellipsis-menu__menu","popover",s);return w.a.createElement("span",{className:c},w.a.createElement(T.a,{ref:this.popoverContext,onClick:this.handleClick,title:t||n("Toggle menu"),borderless:!0,disabled:a,className:"ellipsis-menu__toggle"},w.a.createElement(D.a,{icon:"ellipsis",className:"ellipsis-menu__toggle-icon"})),w.a.createElement(S,{isVisible:l,onClose:this.hideMenu,position:i,context:this.popoverContext.current,className:u},o))}}]),t}(k.Component));b()(z,"propTypes",{translate:E.a.func,toggleTitle:E.a.string,position:E.a.string,disabled:E.a.bool,onClick:E.a.func,onToggle:E.a.func,popoverClassName:E.a.string}),b()(z,"defaultProps",{onClick:C.noop,onToggle:C.noop});var A=Object(v.localize)(z),V=n(530),B=n.n(V),H=n(629),U=function(e){function t(){var e,n;o()(this,t);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return n=l()(this,(e=u()(t)).call.apply(e,[this].concat(a))),b()(p()(n),"handleMouseOver",function(e){n.props.focusOnHover&&e.target.focus(),n.props.onMouseOver()}),n}return h()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.className,i=e.href,o=e.icon,a=e.isSelected,r=e.isExternalLink,s=Object(C.omit)(this.props,"icon","focusOnHover","isSelected","isExternalLink","className","itemComponent"),l=x()("popover__menu-item",n,{"is-selected":a}),c=this.props.itemComponent;return r&&i?(c=H.a,s.icon=!0):i&&(c="a"),w.a.createElement(c,B()({role:"menuitem",onMouseOver:this.handleMouseOver,tabIndex:"-1",className:l},s),o&&w.a.createElement(D.a,{icon:o,size:18}),t)}}]),t}(k.Component);b()(U,"propTypes",{href:E.a.string,className:E.a.string,isSelected:E.a.bool,icon:E.a.string,focusOnHover:E.a.bool,onMouseOver:E.a.func,isExternalLink:E.a.bool,itemComponent:E.a.oneOfType([E.a.func,E.a.string])}),b()(U,"defaultProps",{isSelected:!1,focusOnHover:!0,onMouseOver:C.noop,itemComponent:"button"});var F=n(552),K=n(548),W=n(540),Y=n(537),J=function(e){var t=e.orderId,n=e.siteId,i=e.refundDialog,o=e.createdDate,a=e.refundableAmount,r=e.currency,s=e.labelId,l=e.translate,c=e.moment,u=function(){return I()(a,r)},d=function(){return e.closeRefundDialog(t,n)},p=[{action:"cancel",label:l("Cancel"),onClick:d},{action:"confirm",onClick:function(){return e.confirmRefund(t,n)},isPrimary:!0,disabled:i&&i.isSubmitting,additionalClassNames:i&&i.isSubmitting?"is-busy":"",label:l("Refund label (-%(amount)s)",{args:{amount:u()}})}];return w.a.createElement(F.a,{additionalClassNames:"label-refund-modal woocommerce wcc-root",isVisible:Boolean(i&&i.labelId===s),onClose:d,buttons:p},w.a.createElement(K.a,null,l("Request a refund")),w.a.createElement("p",null,l("You can request a refund for a shipping label that has not been used to ship a package. It will take at least 14 days to process.")),w.a.createElement("dl",null,w.a.createElement("dt",null,l("Purchase date")),w.a.createElement("dd",null,c(o).format("LLL")),w.a.createElement("dt",null,l("Amount eligible for refund")),w.a.createElement("dd",null,u())))};J.propTypes={siteId:E.a.number.isRequired,orderId:E.a.number.isRequired,refundDialog:E.a.object,createdDate:E.a.number,refundableAmount:E.a.number,currency:E.a.string,labelId:E.a.number,closeRefundDialog:E.a.func.isRequired,confirmRefund:E.a.func.isRequired};var X=Object(g.b)(function(e,t){var n=t.orderId,i=t.siteId,o=Object(Y.s)(e,n,i),a=Object(Y.i)(e,n,i);return{refundDialog:o?a.refundDialog:{}}},function(e){return Object(O.b)({closeRefundDialog:W.e,confirmRefund:W.k},e)})(Object(v.localize)(J)),G=n(590),Q=n(602),Z=function(e){var t=e.orderId,n=e.siteId,i=e.reprintDialog,o=e.paperSize,a=e.storeOptions,r=e.labelId,s=e.translate,l=function(){return e.closeReprintDialog(t,n)},c=[{action:"cancel",label:s("Cancel"),onClick:l},{action:"confirm",onClick:function(){return e.confirmReprint(t,n)},isPrimary:!0,disabled:i&&!i.fileData,additionalClassNames:i&&i.isFetching?"is-busy":"",label:s("Print")}];return w.a.createElement(F.a,{isVisible:Boolean(i&&i.labelId===r),onClose:l,buttons:c,additionalClassNames:"label-reprint-modal woocommerce wcc-root"},w.a.createElement(K.a,null,s("Reprint shipping label")),w.a.createElement("p",null,s("If there was a printing error when you purchased the label, you can print it again.")),w.a.createElement("p",{className:"shipping-label__reprint-modal-notice"},s("NOTE: If you already used the label in a package, printing and using it again is a violation of our terms of service and may result in criminal charges.")),w.a.createElement(G.a,{id:"paper_size",valuesMap:Object(Q.a)(a.origin_country),title:s("Paper size"),value:o,updateValue:function(i){return e.updatePaperSize(t,n,i)}}))};Z.propTypes={siteId:E.a.number.isRequired,orderId:E.a.number.isRequired,reprintDialog:E.a.object,paperSize:E.a.string.isRequired,storeOptions:E.a.object.isRequired,labelId:E.a.number,closeReprintDialog:E.a.func.isRequired,confirmReprint:E.a.func.isRequired};var $=Object(g.b)(function(e,t){var n=t.orderId,i=t.siteId,o=Object(Y.s)(e,n,i),a=Object(Y.i)(e,n,i);return{reprintDialog:o?a.reprintDialog:{},paperSize:a.paperSize,storeOptions:o?a.storeOptions:{}}},function(e){return Object(O.b)({closeReprintDialog:W.f,confirmReprint:W.l,updatePaperSize:W.X},e)})(Object(v.localize)(Z)),ee=n(628),te=n(543),ne=function(e){var t=e.orderId,n=e.siteId,i=e.isVisible,o=e.labelIndex,a=e.serviceName,r=e.packageName,s=e.productNames,l=e.canManagePayments,c=e.receiptId,u=e.translate,d=function(){return e.closeDetailsDialog(t,n)},p=[{action:"close",label:u("Close"),onClick:d}];return w.a.createElement(F.a,{additionalClassNames:"label-details-modal woocommerce wcc-root",isVisible:i,onClose:d,buttons:p},w.a.createElement(K.a,{className:"shipping-label__label-details-modal-heading"},w.a.createElement("span",{className:"shipping-label__label-details-modal-heading-title"},u("Label #%(labelIndex)s details",{args:{labelIndex:o+1}})),l&&c?w.a.createElement("a",{href:"".concat(Object(ee.a)(),"/me/purchases/billing/").concat(c),target:"_blank",rel:"noopener noreferrer"},u("Receipt")):null),w.a.createElement("dl",null,w.a.createElement("dt",null,u("Service")),w.a.createElement("dd",null,a),w.a.createElement("dt",null,u("Package")),w.a.createElement("dd",null,r),w.a.createElement("dt",null,u("Items")),w.a.createElement("dd",null,w.a.createElement("ul",null,s.map(function(e,t){return w.a.createElement("li",{key:t},e)})))))};ne.propTypes={siteId:E.a.number.isRequired,orderId:E.a.number.isRequired,isVisible:E.a.bool,serviceName:E.a.string,packageName:E.a.string,productNames:E.a.array,closeDetailsDialog:E.a.func.isRequired,receiptId:E.a.number};var ie=Object(g.b)(function(e,t){var n=t.orderId,i=t.siteId,o=t.labelId,a=Object(Y.s)(e,n,i),r=Object(Y.i)(e,n,i).detailsDialog;return{isVisible:Boolean(a&&r&&r.labelId===o),canManagePayments:Object(te.q)(e,i)}},function(e){return Object(O.b)({closeDetailsDialog:W.c},e)})(Object(v.localize)(ne)),oe={usps:function(e){return"https://tools.usps.com/go/TrackConfirmAction.action?tLabels=".concat(e)},fedex:function(e){return"https://www.fedex.com/apps/fedextrack/?action=track&tracknumbers=".concat(e)},ups:function(e){return"https://www.ups.com/track?loc=en_US&tracknum=".concat(e)}},ae=function(e){var t=e.tracking,n=e.carrierId,i=e.translate;if(!t)return w.a.createElement("span",null,i("N/A"));var o=oe[n](t);return o?w.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:o},t," ",w.a.createElement(D.a,{icon:"external",size:12})):w.a.createElement("span",null,t)};ae.propTypes={tracking:E.a.string,carrierId:E.a.string};var re=Object(v.localize)(ae),se=function(e){function t(){var e,n;o()(this,t);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return n=l()(this,(e=u()(t)).call.apply(e,[this].concat(a))),b()(p()(n),"renderRefund",function(e,t){var i=n.props,o=i.orderId,a=i.siteId,r=i.translate;if(t)return w.a.createElement(P.a,{position:"top left",text:r("Labels older than 30 days cannot be refunded.")},w.a.createElement("button",{className:"popover__menu-item shipping-label__item-menu-reprint-expired",role:"menuitem",tabIndex:"-1"},w.a.createElement(D.a,{icon:"refund",size:18}),w.a.createElement("span",null," ",r("Request refund")," ")));return w.a.createElement(U,{onClick:function(){n.props.openRefundDialog(o,a,e)},icon:"refund"},r("Request refund"))}),b()(p()(n),"renderReprint",function(e,t){var i=n.props,o=i.orderId,a=i.siteId,r=i.translate;if(t)return w.a.createElement(P.a,{position:"top left",text:r("Label images older than 180 days are deleted by our technology partners for general security and data privacy concerns.")},w.a.createElement("button",{className:"popover__menu-item shipping-label__item-menu-reprint-expired",role:"menuitem",tabIndex:"-1"},w.a.createElement(D.a,{icon:"print",size:18}),w.a.createElement("span",null," ",r("Reprint")," ")));return w.a.createElement(U,{onClick:function(){n.props.openReprintDialog(o,a,e)},icon:"print"},r("Reprint"))}),b()(p()(n),"renderLabelDetails",function(e){var t=n.props,i=t.orderId,o=t.siteId,a=t.translate;return w.a.createElement(U,{onClick:function(){n.props.openDetailsDialog(i,o,e)},icon:"info-outline"},a("View details"))}),b()(p()(n),"renderPickup",function(e){var t=n.props.translate,i={usps:"https://tools.usps.com/schedule-pickup-steps.htm",fedex:"https://www.fedex.com/en-us/shipping/schedule-manage-pickups.html",ups:"https://wwwapps.ups.com/pickup/request"};if(!i.hasOwnProperty(e))return null;return w.a.createElement(U,{onClick:function(){window.open(i[e],"_blank")},icon:"external"},t("Schedule a pickup"))}),n}return h()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.label,n=t.labelIndex,i=t.serviceName,o=t.packageName,a=t.productNames,r=t.receiptId,s=t.labelId,l=t.createdDate,c=t.refundableAmount,u=t.currency,d=t.showDetails,p=t.expiryDate,m=t.anonymized,h=t.usedDate,f=t.tracking,b=t.carrierId,g=e.siteId,v=e.orderId,y=e.translate,E=e.isModal,k=(new Date).getTime(),C=!1,R=!1;(m||h||p&&p<k)&&(C=!0);var _=(new Date).setDate((new Date).getDate()-30);return(m||h||l&&l<_)&&(R=!0),w.a.createElement("div",{className:"shipping-label__item"},w.a.createElement("p",{className:"shipping-label__item-detail"},y("%(service)s label (#%(labelIndex)d)",{args:{service:i,labelIndex:n+1}}),d&&w.a.createElement("span",null,!E&&w.a.createElement(A,{position:"bottom left"},this.renderLabelDetails(s),this.renderPickup(b),this.renderRefund(s,R),this.renderReprint(s,C)),w.a.createElement(ie,{siteId:g,orderId:v,labelIndex:n,serviceName:i,packageName:o,productNames:a,receiptId:r,labelId:s}),w.a.createElement(X,{siteId:g,orderId:v,createdDate:l,refundableAmount:c,currency:u,labelId:s}),w.a.createElement($,{siteId:g,orderId:v,labelId:s}))),d&&w.a.createElement("p",{className:"shipping-label__item-tracking"},y("Tracking #: {{trackingLink/}}",{components:{trackingLink:w.a.createElement(re,{carrierId:b,tracking:f})}})))}}]),t}(k.Component);se.propTypes={siteId:E.a.number.isRequired,orderId:E.a.number.isRequired,label:E.a.shape({serviceName:E.a.string.isRequired,labelIndex:E.a.number.isRequired,packageName:E.a.string.isRequired,productNames:E.a.string.isRequired,receiptId:E.a.number.isRequired,labelId:E.a.number.isRequired,createdDate:E.a.string.isRequired,refundableAmount:E.a.number.isRequired,currency:E.a.string.isRequired,showDetails:E.a.bool.isRequired,expiryDate:E.a.string.isRequired,anonymized:E.a.bool.isRequired,usedDate:E.a.string.isRequired,tracking:E.a.string.isRequired,carrierId:E.a.number.isRequired}).isRequired,isModal:E.a.bool.isRequired,openRefundDialog:E.a.func.isRequired,openReprintDialog:E.a.func.isRequired,openDetailsDialog:E.a.func.isRequired};var le=Object(g.b)(null,function(e){return Object(O.b)({openRefundDialog:W.y,openReprintDialog:W.z,openDetailsDialog:W.u},e)})(Object(v.localize)(se)),ce=function(e){function t(){return o()(this,t),l()(this,u()(t).apply(this,arguments))}return h()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.label,n=e.translate,i=t.serviceName,o=t.labelIndex;return w.a.createElement("div",{className:"shipping-label__item"},w.a.createElement("p",{className:"shipping-label__item-detail"},n("%(service)s label (#%(labelIndex)d)",{args:{service:i,labelIndex:o+1}}),w.a.createElement("br",null),n("Purchasing\u2026")))}}]),t}(se);se.propTypes={label:E.a.object.isRequired};var ue=Object(v.localize)(ce),de=n(600),pe=function(e){function t(){var e,n,i;o()(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return i=l()(this,(e=u()(t)).call.apply(e,[this].concat(r))),b()(p()(i),"eventPropsByType",(n={},b()(n,R.a.INTERNAL_NOTE,function(e){return{icon:"aside",heading:(0,i.props.translate)("Internal note"),content:Object(de.a)(Object(de.b)(e.content))}}),b()(n,R.a.CUSTOMER_NOTE,function(e){return{icon:"mail",heading:(0,i.props.translate)("Note sent to customer"),content:Object(de.a)(Object(de.b)(e.content))}}),b()(n,R.a.LABEL_PURCHASING,function(e){return{icon:"sync",content:w.a.createElement(ue,{label:e,orderId:i.props.orderId,siteId:i.props.siteId})}}),b()(n,R.a.LABEL_PURCHASED,function(e){return{icon:"print",content:w.a.createElement(le,{label:e,orderId:i.props.orderId,siteId:i.props.siteId,isModal:i.props.isModal})}}),b()(n,R.a.LABEL_REFUND_REQUESTED,function(e){var t=i.props.translate;return{icon:"time",content:w.a.createElement("div",null,t("%(service)s label (#%(labelNum)d) refund requested (%(amount)s)",{args:{service:e.serviceName,labelNum:e.labelIndex+1,amount:I()(e.amount,e.currency)}}))}}),b()(n,R.a.LABEL_REFUND_COMPLETED,function(e){var t=i.props.translate;return{icon:"refund",content:w.a.createElement("div",null,t("%(service)s label (#%(labelNum)d) refunded (%(amount)s)",{args:{service:e.serviceName,labelNum:e.labelIndex+1,amount:I()(e.amount,e.currency)}}))}}),b()(n,R.a.LABEL_REFUND_REJECTED,function(e){var t=i.props.translate;return{icon:"cross-small",content:w.a.createElement("div",null,t("%(service)s label (#%(labelNum)d) refund rejected",{service:e.serviceName,args:{labelNum:e.labelIndex+1}}))}}),b()(n,R.a.REFUND_NOTE,function(e){var t=i.props.translate;return{icon:"credit-card",heading:t("Refund"),content:w.a.createElement("div",null,t("Refunded %(amount)s",{args:{amount:I()(e.amount,e.currency)}}),w.a.createElement("br",null),e.reason)}}),b()(n,void 0,function(){return{}}),n)),b()(p()(i),"renderDefaultEvent",function(e){return{icon:"aside",heading:(0,i.props.translate)("Note"),content:e.content}}),i}return h()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.moment,n=e.event,i=(this.eventPropsByType[n.type]||this.renderDefaultEvent)(n),o=i.icon,a=i.heading,r=i.content;return w.a.createElement("div",{className:"order-activity-log__note"},w.a.createElement("div",{className:"order-activity-log__note-meta"},w.a.createElement("span",{className:"order-activity-log__note-time"},t(n.timestamp).format("LT")),o&&w.a.createElement(D.a,{icon:o,size:24})),w.a.createElement("div",{className:"order-activity-log__note-body"},w.a.createElement("div",{className:"order-activity-log__note-type"},a),w.a.createElement("div",{className:"order-activity-log__note-content"},r)))}}]),t}(k.Component);b()(pe,"propTypes",{customer_note:E.a.bool,date_created_gmt:E.a.string,note:E.a.string.isRequired}),b()(pe,"propTypes",{event:E.a.object}),b()(pe,"defaultProps",{event:{}});var me=Object(v.localize)(pe),he=n(587),fe=function(e){function t(){var e,n;o()(this,t);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return n=l()(this,(e=u()(t)).call.apply(e,[this].concat(a))),b()(p()(n),"onClick",function(){n.props.onClick(n.props.date)}),n}return h()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.count,n=e.date,i=e.isOpen,o=e.moment,a=e.translate,r=o(n,"YYYYMMDD").format("ll"),s=w.a.createElement("div",null,w.a.createElement("h3",null,r),w.a.createElement("small",null,a("%(count)s event","%(count)s events",{count:t,args:{count:t}})));return w.a.createElement("div",{className:"order-activity-log__day"},w.a.createElement(he.a,{onClick:this.onClick,className:"order-activity-log__day-header",expanded:i,header:s,screenReaderText:a("Show notes from %(date)s",{args:{date:r}})},this.props.children))}}]),t}(k.Component);b()(fe,"propTypes",{count:E.a.number.isRequired,date:E.a.string.isRequired,isOpen:E.a.bool.isRequired,onClick:E.a.func.isRequired});var be=Object(v.localize)(fe);var ge=function(e){function t(){var e,n;o()(this,t);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return n=l()(this,(e=u()(t)).call.apply(e,[this].concat(a))),b()(p()(n),"toggleOpenDay",function(e){n.setState(function(){return{openDay:e}})}),b()(p()(n),"renderNotes",function(){var e=n.props,t=e.days,i=e.eventsByDay,o=e.translate;return t.length?w.a.createElement("div",null,t.map(function(e){var t=i[e];return w.a.createElement(be,{key:e,count:t.length,date:e,isOpen:e===n.state.openDay,onClick:n.toggleOpenDay},t.map(function(e){return w.a.createElement(me,{key:"".concat(e.type,"-").concat(e.key),event:e,orderId:n.props.orderId,siteId:n.props.siteId,isModal:n.props.isModal})}))})):w.a.createElement("p",null,o("No activity yet"))}),b()(p()(n),"renderPlaceholder",function(){return w.a.createElement("div",{className:"is-placeholder"},w.a.createElement(be,{count:0,date:"",isOpen:!0,index:1,onClick:C.noop},w.a.createElement(me,null)))}),n}return h()(t,e),r()(t,[{key:"UNSAFE_componentWillMount",value:function(){this.setState({openDay:Object(C.last)(Object(C.keys)(this.props.eventsByDay))})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=Object(C.last)(Object(C.keys)(e.eventsByDay));this.props.eventsByDay[t]||this.setState({openDay:t})}},{key:"render",value:function(){return this.props.isLoaded?this.renderNotes():this.renderPlaceholder()}}]),t}(k.Component);b()(ge,"propTypes",{orderId:E.a.number.isRequired,siteId:E.a.number.isRequired});t.a=Object(g.b)(function(e,t){var n=t.orderId||!1,i=Object(R.c)(e,n),o=Object(R.b)(e,n),a=o.length?function(e){var t={};return e.forEach(function(e){var n=Object(v.moment)(e.timestamp).format("YYYYMMDD");t[n]?t[n].push(e):t[n]=[e]}),Object(C.keys)(t).forEach(function(e){t[e]=Object(C.sortBy)(t[e],["timestamp","key"]).reverse()}),t}(o):{},r=a?Object(C.keys)(a):[];return r.sort().reverse(),{isLoaded:i,days:r,events:o,eventsByDay:a}})(Object(v.localize)(ge))},786:function(e,t,n){"use strict";n.r(t);var i=n(10),o=n.n(i),a=n(12),r=n.n(a),s=n(109),l=n(30),c=n(35),u=n(534),d=n.n(u),p=n(552),m=n(548),h=n(540),f=n(544),b=n(537),g=n(682),v=function(e){var t=e.loaded,n=e.translate;if(!t)return null;var i=function(){return e.exitTrackingFlow(e.orderId,e.siteId,!1)};return o.a.createElement(p.a,{additionalClassNames:"woocommerce tracking-modal wcc-root",isVisible:e.showTrackingDialog,onClose:i},o.a.createElement("div",{className:"tracking-modal__content"},o.a.createElement("div",{className:"tracking-modal__header"},o.a.createElement(m.a,null,n("Which package would you like to track?")),o.a.createElement(f.a,{className:"tracking-modal__close-button",onClick:i},o.a.createElement(d.a,{icon:"cross"}))),o.a.createElement("div",{className:"tracking-modal__body"},o.a.createElement("div",{className:"tracking-modal__main-section"},o.a.createElement("div",{className:"shipment-tracking__dummy-class order-activity-log"},o.a.createElement(g.a,{orderId:e.orderId,siteId:e.siteId,isModal:!0}))))))};v.propTypes={siteId:r.a.number.isRequired,orderId:r.a.number.isRequired};t.default=Object(s.b)(function(e,t){var n=t.orderId,i=t.siteId,o=Object(b.s)(e,n,i),a=Object(b.i)(e,n,i);return{loaded:o,form:o&&a.form,showTrackingDialog:a.showTrackingDialog,isCustomsFormRequired:Object(b.o)(e,n,i)}},function(e){return Object(l.b)({exitTrackingFlow:h.p},e)})(Object(c.localize)(v))}}]);